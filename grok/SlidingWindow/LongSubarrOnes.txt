Longest Subarray with Ones after Replacement (hard)

problem:
